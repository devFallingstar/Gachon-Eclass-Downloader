package System;

import Session.*;

import java.io.IOException;
import java.util.ArrayList;
import java.util.List;

import com.gargoylesoftware.htmlunit.FailingHttpStatusCodeException;
import com.gargoylesoftware.htmlunit.WebClient;
import com.gargoylesoftware.htmlunit.html.DomElement;
import com.gargoylesoftware.htmlunit.html.HtmlPage;

import FileProcess.*;

public class MainSystem {
	private static MainSystem myMain = new MainSystem();
	private GachonSession tmp1;
	private WebClient myClient;
	private HtmlPage myPage;
	private List<String> lectureList;
	private List<String> fileList;
	
	public static void main(String[] args) {
		myMain = new MainSystem();
	}
	
	public MainSystem(){
		int resultCode;
		this.tmp1 = new GachonSession();
		resultCode = this.tmp1.logIn("stardung86", "Netdong12");
		
		if (resultCode == 0){
			myClient = this.tmp1.getSession();
			try {
				myPage = (HtmlPage)myClient.getPage("http://eclass.gachon.ac.kr/index.jsp");
				
				lectureList = this.getLectureList();
				//TODO : File List get and download
				
			} catch (Exception e) {
				e.printStackTrace();
			}
		}else{
			System.out.println("Web page Loading failed!");
		}
	}
	
	public void startDownload(String url, String name, String dir){
		FileDownloader.downloadWithURL(url, name, dir);
	}
	
	private List<String> getLectureList(){
		List<String> resultList = new ArrayList<String>();
		List<DomElement> divList = myPage.getElementsByTagName("a");
		
		for (DomElement e : divList){
			if (e.getAttribute("href").startsWith("/myMain.jsp?Forum_seq=")){
				if ()
				
				
				System.out.println(e.getAttribute("href"));
			}
		}
		
		return null;
	}
	
	private List<String> getFileList(String lectureURL){
		List<String> files = null;
		
		return null;
	}

}
